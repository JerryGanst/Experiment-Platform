2025-06-08 13:12:30,604 - __main__ - INFO - Starting CAKE experiment suite with run name: cake_run_20250608_131230
2025-06-08 13:12:30,604 - __main__ - INFO - Arguments: Namespace(model_name='meta-llama/Llama-2-7b-chat-hf', datasets='narrativeqa', kv_cache_lengths='1024', batch_sizes='1', max_new_tokens=256, allocation_strategies='adaptive', cache_budgets='0.2', repetitions=1, output_dir='mha_results/meta-llama_Llama-2-7b-chat-hf/narrativeqa_ctx1024_bud0.2', log_level='INFO', seed=42, run_name='cake_run_20250608_131230')
2025-06-08 13:12:30,604 - __main__ - INFO - Global EXPERIMENT_CONFIG being used: {'model_name_or_path': 'NousResearch/Llama-2-7b-hf', 'precision': 'fp16', 'datasets': ['mmlu', 'gsm8k', 'winogrande', 'arc_challenge', 'hellaswag', 'truthful_qa_mc'], 'dataset_subset_size': {'mmlu': 100, 'gsm8k': 100, 'winogrande': None, 'arc_challenge': None, 'hellaswag': None, 'truthful_qa_mc': None, 'pubmed_qa': 100, 'cais/mmlu-zh': 50}, 'kv_cache_lengths': [512, 1024, 2048], 'batch_sizes': [1, 4, 8], 'max_new_tokens': 256, 'repetitions': 3, 'h2o_enabled': True, 'h2o_ratios': [0.1, 0.2, 0.3], 'eviction_strategies': ['attention', 'time_decay', 'hybrid'], 'h2o_kv_cache_lengths': [512, 1024], 'cake_enabled': True, 'layer_allocation_strategies': ['uniform', 'adaptive', 'attention_based'], 'layer_analysis_configs': {'attention_pattern_analysis': True, 'layer_importance_scoring': True, 'dynamic_allocation': True}, 'cache_budgets': [0.5, 0.7, 0.9], 'cake_kv_cache_lengths': [512, 1024], 'head_level_optimization': False, 'head_analysis_enabled': False, 'head_selection_strategy': 'top_k', 'head_k_value': 10, 'output_base_dir': 'results', 'enable_monitoring': True, 'monitor_interval': 0.5}
2025-06-08 13:12:30,604 - __main__ - INFO - Global CAKE_MODEL_CONFIG being used: {'default_allocation_strategy': 'adaptive', 'default_cache_budget': 0.8, 'supported_models_cake': ['llama', 'mistral', 'qwen2'], 'dynamic_allocation_default': True, 'layer_analysis_default': {'attention_pattern_analysis': True, 'layer_importance_scoring': True}}
2025-06-08 13:12:30,619 - __main__ - INFO - Random seed set to 42
2025-06-08 13:12:30,619 - __main__ - INFO - Total number of CAKE experiment configurations to run: 1
2025-06-08 13:12:30,620 - __main__ - ERROR - Dataset configuration for 'narrativeqa' not found in DATASET_CONFIG. Skipping...
2025-06-08 13:12:30,620 - __main__ - INFO - CAKE experiment suite finished.
